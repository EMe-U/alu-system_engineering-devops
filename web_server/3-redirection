#!/usr/bin/env bash
#
# This script configures Nginx to set up a 301 redirection for /redirect_me

# Update the package list and install Nginx
sudo apt update
sudo apt install -y nginx

# Create a new Nginx configuration file for the redirection
REDIRECT_CONF="/etc/nginx/sites-available/redirect_me"

# Check if the configuration already exists
if [ ! -f "$REDIRECT_CONF" ]; then
    # Create the Nginx server block for redirection
    sudo bash -c "cat > $REDIRECT_CONF" << EOF
server {
    listen 80;
    server_name _;

    location /redirect_me {
        return 301 https://www.youtube.com/watch?v=QH2-TGUlwu4;
    }
}
EOF
fi

# Enable the new configuration
sudo ln -sf /etc/nginx/sites-available/redirect_me /etc/nginx/sites-enabled/

# Remove the default Nginx site if needed
sudo rm -f /etc/nginx/sites-enabled/default

# Restart Nginx to apply changes
sudo systemctl restart nginx

# Ensure Nginx is enabled to start on boot
sudo systemctl enable nginx

echo "Redirection configured. Access http://<your-server-ip>/redirect_me to test it."

